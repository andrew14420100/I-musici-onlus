{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":193},"end":{"line":4,"column":51,"index":244}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (!context) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [isInitialized, setIsInitialized] = (0, _react.useState)(false);\n    const checkExistingSession = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        console.log('Checking existing session, token exists:', !!token);\n        if (token) {\n          const userData = await _servicesApi.authApi.getMe();\n          console.log('Session valid, user:', userData.email, userData.ruolo);\n          setUser(userData);\n          return true;\n        }\n      } catch (error) {\n        console.log('No valid session');\n        await AsyncStorage.default.removeItem('session_token');\n      }\n      return false;\n    };\n    (0, _react.useEffect)(() => {\n      const init = async () => {\n        console.log('=== Auth Init Start ===');\n        setIsLoading(true);\n        setIsInitialized(false);\n\n        // First seed the database (silent)\n        try {\n          await _servicesApi.seedApi.seed();\n        } catch (e) {\n          // Ignore\n        }\n\n        // Check existing session\n        await checkExistingSession();\n        setIsLoading(false);\n        setIsInitialized(true);\n        console.log('=== Auth Init Complete ===');\n      };\n      init();\n    }, []);\n    const loginWithCredentials = async (email, password) => {\n      try {\n        console.log('Attempting login for:', email);\n        const response = await _servicesApi.authApi.login(email, password);\n        if (response.token) {\n          await AsyncStorage.default.setItem('session_token', response.token);\n          setUser(response.user);\n          console.log('Login successful for:', response.user.email);\n          return {\n            success: true\n          };\n        }\n        return {\n          success: false,\n          error: 'Token non ricevuto'\n        };\n      } catch (error) {\n        console.error('Login error:', error.response?.data || error.message);\n        return {\n          success: false,\n          error: error.response?.data?.detail || 'Errore durante il login'\n        };\n      }\n    };\n    const logout = async () => {\n      try {\n        await _servicesApi.authApi.logout();\n      } catch (error) {\n        // Ignore\n      }\n      await AsyncStorage.default.removeItem('session_token');\n      setUser(null);\n      console.log('Logged out');\n    };\n    const refreshUser = async () => {\n      await checkExistingSession();\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        isInitialized,\n        isAuthenticated: !!user,\n        loginWithCredentials,\n        logout,\n        refreshUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }, this);\n  };\n});","lineCount":135,"map":[[13,2,18,0,"Object"],[13,8,18,0],[13,9,18,0,"defineProperty"],[13,23,18,0],[13,24,18,0,"exports"],[13,31,18,0],[14,4,18,0,"enumerable"],[14,14,18,0],[15,4,18,0,"get"],[15,7,18,0],[15,18,18,0,"get"],[15,19,18,0],[16,6,18,0],[16,13,18,0,"useAuth"],[16,20,18,0],[17,4,18,0],[18,2,18,0],[19,2,30,0,"Object"],[19,8,30,0],[19,9,30,0,"defineProperty"],[19,23,30,0],[19,24,30,0,"exports"],[19,31,30,0],[20,4,30,0,"enumerable"],[20,14,30,0],[21,4,30,0,"get"],[21,7,30,0],[21,18,30,0,"get"],[21,19,30,0],[22,6,30,0],[22,13,30,0,"AuthProvider"],[22,25,30,0],[23,4,30,0],[24,2,30,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,4,0],[28,6,4,0,"_servicesApi"],[28,18,4,0],[28,21,4,0,"require"],[28,28,4,0],[28,29,4,0,"_dependencyMap"],[28,43,4,0],[29,2,4,51],[29,6,4,51,"_reactJsxDevRuntime"],[29,25,4,51],[29,28,4,51,"require"],[29,35,4,51],[29,36,4,51,"_dependencyMap"],[29,50,4,51],[30,2,16,0],[30,8,16,6,"AuthContext"],[30,19,16,17],[30,35,16,20],[30,39,16,20,"createContext"],[30,45,16,33],[30,46,16,33,"createContext"],[30,59,16,33],[30,61,16,63,"undefined"],[30,70,16,72],[30,71,16,73],[31,2,18,7],[31,8,18,13,"useAuth"],[31,15,18,20],[31,18,18,23,"useAuth"],[31,19,18,23],[31,24,18,29],[32,4,19,2],[32,10,19,8,"context"],[32,17,19,15],[32,20,19,18],[32,24,19,18,"useContext"],[32,30,19,28],[32,31,19,28,"useContext"],[32,41,19,28],[32,43,19,29,"AuthContext"],[32,54,19,40],[32,55,19,41],[33,4,20,2],[33,8,20,6],[33,9,20,7,"context"],[33,16,20,14],[33,18,20,16],[34,6,21,4],[34,12,21,10],[34,16,21,14,"Error"],[34,21,21,19],[34,22,21,20],[34,67,21,65],[34,68,21,66],[35,4,22,2],[36,4,23,2],[36,11,23,9,"context"],[36,18,23,16],[37,2,24,0],[37,3,24,1],[38,2,30,7],[38,8,30,13,"AuthProvider"],[38,20,30,54],[38,23,30,57,"AuthProvider"],[38,24,30,58],[39,4,30,60,"children"],[40,2,30,69],[40,3,30,70],[40,8,30,75],[41,4,31,2],[41,10,31,8],[41,11,31,9,"user"],[41,15,31,13],[41,17,31,15,"setUser"],[41,24,31,22],[41,25,31,23],[41,28,31,26],[41,32,31,26,"useState"],[41,38,31,34],[41,39,31,34,"useState"],[41,47,31,34],[41,49,31,48],[41,53,31,52],[41,54,31,53],[42,4,32,2],[42,10,32,8],[42,11,32,9,"isLoading"],[42,20,32,18],[42,22,32,20,"setIsLoading"],[42,34,32,32],[42,35,32,33],[42,38,32,36],[42,42,32,36,"useState"],[42,48,32,44],[42,49,32,44,"useState"],[42,57,32,44],[42,59,32,45],[42,63,32,49],[42,64,32,50],[43,4,33,2],[43,10,33,8],[43,11,33,9,"isInitialized"],[43,24,33,22],[43,26,33,24,"setIsInitialized"],[43,42,33,40],[43,43,33,41],[43,46,33,44],[43,50,33,44,"useState"],[43,56,33,52],[43,57,33,52,"useState"],[43,65,33,52],[43,67,33,53],[43,72,33,58],[43,73,33,59],[44,4,35,2],[44,10,35,8,"checkExistingSession"],[44,30,35,28],[44,33,35,31],[44,39,35,31,"checkExistingSession"],[44,40,35,31],[44,45,35,43],[45,6,36,4],[45,10,36,8],[46,8,37,6],[46,14,37,12,"token"],[46,19,37,17],[46,22,37,20],[46,28,37,26,"AsyncStorage"],[46,40,37,38],[46,41,37,38,"default"],[46,48,37,38],[46,49,37,39,"getItem"],[46,56,37,46],[46,57,37,47],[46,72,37,62],[46,73,37,63],[47,8,38,6,"console"],[47,15,38,13],[47,16,38,14,"log"],[47,19,38,17],[47,20,38,18],[47,62,38,60],[47,64,38,62],[47,65,38,63],[47,66,38,64,"token"],[47,71,38,69],[47,72,38,70],[48,8,39,6],[48,12,39,10,"token"],[48,17,39,15],[48,19,39,17],[49,10,40,8],[49,16,40,14,"userData"],[49,24,40,22],[49,27,40,25],[49,33,40,31,"authApi"],[49,45,40,38],[49,46,40,38,"authApi"],[49,53,40,38],[49,54,40,39,"getMe"],[49,59,40,44],[49,60,40,45],[49,61,40,46],[50,10,41,8,"console"],[50,17,41,15],[50,18,41,16,"log"],[50,21,41,19],[50,22,41,20],[50,44,41,42],[50,46,41,44,"userData"],[50,54,41,52],[50,55,41,53,"email"],[50,60,41,58],[50,62,41,60,"userData"],[50,70,41,68],[50,71,41,69,"ruolo"],[50,76,41,74],[50,77,41,75],[51,10,42,8,"setUser"],[51,17,42,15],[51,18,42,16,"userData"],[51,26,42,24],[51,27,42,25],[52,10,43,8],[52,17,43,15],[52,21,43,19],[53,8,44,6],[54,6,45,4],[54,7,45,5],[54,8,45,6],[54,15,45,13,"error"],[54,20,45,18],[54,22,45,20],[55,8,46,6,"console"],[55,15,46,13],[55,16,46,14,"log"],[55,19,46,17],[55,20,46,18],[55,38,46,36],[55,39,46,37],[56,8,47,6],[56,14,47,12,"AsyncStorage"],[56,26,47,24],[56,27,47,24,"default"],[56,34,47,24],[56,35,47,25,"removeItem"],[56,45,47,35],[56,46,47,36],[56,61,47,51],[56,62,47,52],[57,6,48,4],[58,6,49,4],[58,13,49,11],[58,18,49,16],[59,4,50,2],[59,5,50,3],[60,4,52,2],[60,8,52,2,"useEffect"],[60,14,52,11],[60,15,52,11,"useEffect"],[60,24,52,11],[60,26,52,12],[60,32,52,18],[61,6,53,4],[61,12,53,10,"init"],[61,16,53,14],[61,19,53,17],[61,25,53,17,"init"],[61,26,53,17],[61,31,53,29],[62,8,54,6,"console"],[62,15,54,13],[62,16,54,14,"log"],[62,19,54,17],[62,20,54,18],[62,45,54,43],[62,46,54,44],[63,8,55,6,"setIsLoading"],[63,20,55,18],[63,21,55,19],[63,25,55,23],[63,26,55,24],[64,8,56,6,"setIsInitialized"],[64,24,56,22],[64,25,56,23],[64,30,56,28],[64,31,56,29],[66,8,58,6],[67,8,59,6],[67,12,59,10],[68,10,60,8],[68,16,60,14,"seedApi"],[68,28,60,21],[68,29,60,21,"seedApi"],[68,36,60,21],[68,37,60,22,"seed"],[68,41,60,26],[68,42,60,27],[68,43,60,28],[69,8,61,6],[69,9,61,7],[69,10,61,8],[69,17,61,15,"e"],[69,18,61,16],[69,20,61,18],[70,10,62,8],[71,8,62,8],[73,8,65,6],[74,8,66,6],[74,14,66,12,"checkExistingSession"],[74,34,66,32],[74,35,66,33],[74,36,66,34],[75,8,68,6,"setIsLoading"],[75,20,68,18],[75,21,68,19],[75,26,68,24],[75,27,68,25],[76,8,69,6,"setIsInitialized"],[76,24,69,22],[76,25,69,23],[76,29,69,27],[76,30,69,28],[77,8,70,6,"console"],[77,15,70,13],[77,16,70,14,"log"],[77,19,70,17],[77,20,70,18],[77,48,70,46],[77,49,70,47],[78,6,71,4],[78,7,71,5],[79,6,73,4,"init"],[79,10,73,8],[79,11,73,9],[79,12,73,10],[80,4,74,2],[80,5,74,3],[80,7,74,5],[80,9,74,7],[80,10,74,8],[81,4,76,2],[81,10,76,8,"loginWithCredentials"],[81,30,76,28],[81,33,76,31],[81,39,76,31,"loginWithCredentials"],[81,40,76,38,"email"],[81,45,76,51],[81,47,76,53,"password"],[81,55,76,69],[81,60,76,121],[82,6,77,4],[82,10,77,8],[83,8,78,6,"console"],[83,15,78,13],[83,16,78,14,"log"],[83,19,78,17],[83,20,78,18],[83,43,78,41],[83,45,78,43,"email"],[83,50,78,48],[83,51,78,49],[84,8,79,6],[84,14,79,12,"response"],[84,22,79,20],[84,25,79,23],[84,31,79,29,"authApi"],[84,43,79,36],[84,44,79,36,"authApi"],[84,51,79,36],[84,52,79,37,"login"],[84,57,79,42],[84,58,79,43,"email"],[84,63,79,48],[84,65,79,50,"password"],[84,73,79,58],[84,74,79,59],[85,8,81,6],[85,12,81,10,"response"],[85,20,81,18],[85,21,81,19,"token"],[85,26,81,24],[85,28,81,26],[86,10,82,8],[86,16,82,14,"AsyncStorage"],[86,28,82,26],[86,29,82,26,"default"],[86,36,82,26],[86,37,82,27,"setItem"],[86,44,82,34],[86,45,82,35],[86,60,82,50],[86,62,82,52,"response"],[86,70,82,60],[86,71,82,61,"token"],[86,76,82,66],[86,77,82,67],[87,10,83,8,"setUser"],[87,17,83,15],[87,18,83,16,"response"],[87,26,83,24],[87,27,83,25,"user"],[87,31,83,29],[87,32,83,30],[88,10,84,8,"console"],[88,17,84,15],[88,18,84,16,"log"],[88,21,84,19],[88,22,84,20],[88,45,84,43],[88,47,84,45,"response"],[88,55,84,53],[88,56,84,54,"user"],[88,60,84,58],[88,61,84,59,"email"],[88,66,84,64],[88,67,84,65],[89,10,85,8],[89,17,85,15],[90,12,85,17,"success"],[90,19,85,24],[90,21,85,26],[91,10,85,31],[91,11,85,32],[92,8,86,6],[93,8,87,6],[93,15,87,13],[94,10,87,15,"success"],[94,17,87,22],[94,19,87,24],[94,24,87,29],[95,10,87,31,"error"],[95,15,87,36],[95,17,87,38],[96,8,87,59],[96,9,87,60],[97,6,88,4],[97,7,88,5],[97,8,88,6],[97,15,88,13,"error"],[97,20,88,23],[97,22,88,25],[98,8,89,6,"console"],[98,15,89,13],[98,16,89,14,"error"],[98,21,89,19],[98,22,89,20],[98,36,89,34],[98,38,89,36,"error"],[98,43,89,41],[98,44,89,42,"response"],[98,52,89,50],[98,54,89,52,"data"],[98,58,89,56],[98,62,89,60,"error"],[98,67,89,65],[98,68,89,66,"message"],[98,75,89,73],[98,76,89,74],[99,8,90,6],[99,15,90,13],[100,10,91,8,"success"],[100,17,91,15],[100,19,91,17],[100,24,91,22],[101,10,92,8,"error"],[101,15,92,13],[101,17,92,15,"error"],[101,22,92,20],[101,23,92,21,"response"],[101,31,92,29],[101,33,92,31,"data"],[101,37,92,35],[101,39,92,37,"detail"],[101,45,92,43],[101,49,92,47],[102,8,93,6],[102,9,93,7],[103,6,94,4],[104,4,95,2],[104,5,95,3],[105,4,97,2],[105,10,97,8,"logout"],[105,16,97,14],[105,19,97,17],[105,25,97,17,"logout"],[105,26,97,17],[105,31,97,29],[106,6,98,4],[106,10,98,8],[107,8,99,6],[107,14,99,12,"authApi"],[107,26,99,19],[107,27,99,19,"authApi"],[107,34,99,19],[107,35,99,20,"logout"],[107,41,99,26],[107,42,99,27],[107,43,99,28],[108,6,100,4],[108,7,100,5],[108,8,100,6],[108,15,100,13,"error"],[108,20,100,18],[108,22,100,20],[109,8,101,6],[110,6,101,6],[111,6,103,4],[111,12,103,10,"AsyncStorage"],[111,24,103,22],[111,25,103,22,"default"],[111,32,103,22],[111,33,103,23,"removeItem"],[111,43,103,33],[111,44,103,34],[111,59,103,49],[111,60,103,50],[112,6,104,4,"setUser"],[112,13,104,11],[112,14,104,12],[112,18,104,16],[112,19,104,17],[113,6,105,4,"console"],[113,13,105,11],[113,14,105,12,"log"],[113,17,105,15],[113,18,105,16],[113,30,105,28],[113,31,105,29],[114,4,106,2],[114,5,106,3],[115,4,108,2],[115,10,108,8,"refreshUser"],[115,21,108,19],[115,24,108,22],[115,30,108,22,"refreshUser"],[115,31,108,22],[115,36,108,34],[116,6,109,4],[116,12,109,10,"checkExistingSession"],[116,32,109,30],[116,33,109,31],[116,34,109,32],[117,4,110,2],[117,5,110,3],[118,4,112,2],[118,24,113,4],[118,28,113,4,"_reactJsxDevRuntime"],[118,47,113,4],[118,48,113,4,"jsxDEV"],[118,54,113,4],[118,56,113,5,"AuthContext"],[118,67,113,16],[118,68,113,17,"Provider"],[118,76,113,25],[119,6,114,6,"value"],[119,11,114,11],[119,13,114,13],[120,8,115,8,"user"],[120,12,115,12],[121,8,116,8,"isLoading"],[121,17,116,17],[122,8,117,8,"isInitialized"],[122,21,117,21],[123,8,118,8,"isAuthenticated"],[123,23,118,23],[123,25,118,25],[123,26,118,26],[123,27,118,27,"user"],[123,31,118,31],[124,8,119,8,"loginWithCredentials"],[124,28,119,28],[125,8,120,8,"logout"],[125,14,120,14],[126,8,121,8,"refreshUser"],[127,6,122,6],[127,7,122,8],[128,6,122,8,"children"],[128,14,122,8],[128,16,124,7,"children"],[129,4,124,15],[130,6,124,15,"fileName"],[130,14,124,15],[130,16,124,15,"_jsxFileName"],[130,28,124,15],[131,6,124,15,"lineNumber"],[131,16,124,15],[132,6,124,15,"columnNumber"],[132,18,124,15],[133,4,124,15],[133,11,125,26],[133,12,125,27],[134,2,127,0],[134,3,127,1],[135,0,127,2],[135,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","checkExistingSession","useEffect$argument_0","init","loginWithCredentials","logout","refreshUser"],"mappings":"AAA;uBCiB;CDM;yDEM;+BCK;GDe;YEE;iBCC;KDkB;GFG;+BIE;GJmB;iBKE;GLS;sBME;GNE;CFiB"},"hasCjsExports":false},"type":"js/module"}]}